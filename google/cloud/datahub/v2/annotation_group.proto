// Copyright 2017 Google Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

syntax = "proto3";

package google.cloud.datahub.v2;

import "google/api/annotations.proto";
import "google/iam/v1/policy.proto";
import "google/protobuf/any.proto";

option cc_enable_arenas = true;
option go_package = "google.golang.org/genproto/googleapis/cloud/datahub/v2;datahub";
option java_multiple_files = true;
option java_package = "com.google.cloud.datahub";


// A template which describes Extensible Annotation Groups.
message AnnotationTemplate {
  // The project containing the template
  string project_id = 1;

  // The base name of the template
  string template_name = 2;

  // The Access Controls for the template
  AnnotationTemplateAcl acl = 3;
}

// Describes the ACLs for an AnnotationTemplate
message AnnotationTemplateAcl {
  // Associates a list of 'members' to a 'role'.  Multiple 'bindings' must not
  // be specified for the same 'role'.  'bindings' with no members will result
  // in an error.
  //
  // Valid roles are:
  //   "roles/datahub.template.owner"
  //   "roles/datahub.template.user"
  //   "roles/datahub.template.writer"
  //   "roles/datahub.template.reader"
  // See go/datahub-annotation-design for meanings of those roles.
  // This should NOT be set if using TemplateIamPermission below.
  repeated google.iam.v1.Binding bindings = 1;
}

// A collection of fields which each have a value.
message AnnotationStruct {
  // Unordered map of dynamically typed values.
  map<string, AnnotationValue> fields = 1;
}

// This is a Structured Annotation which can be nested.
message AnnotationValue {
  // The kind of value.
  oneof kind {
    // Represents a null value.
    AnnotationNullValue null_value = 1;

    // Represents a double value.
    double double_value = 2;

    // Represents a string value.
    string string_value = 3;

    // Represents a boolean value.
    bool bool_value = 4;

    // Represents a structured value.
    AnnotationStruct struct_value = 5;

    // Represents a repeated `Value`.
    AnnotationListValue list_value = 6;

    // Represents a google.protobuf.Any value.
    google.protobuf.Any any_value = 7;
  }
}

// This is an order list of annotations.
message AnnotationListValue {
  // Repeated field of dynamically typed values.
  repeated AnnotationValue values = 1;
}

// A collection of annotations which are extensible
message ExtensibleAnnotationGroup {
  // This maps the name of an annotation to a struct Value
  map<string, AnnotationValue> annotations = 1;
}

// This a null annotation value.
enum AnnotationNullValue {
  // Null value.
  NULL_VALUE = 0;
}
