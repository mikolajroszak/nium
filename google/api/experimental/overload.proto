// Copyright 2018 Google LLC
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     https://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

syntax = "proto3";

package google.api.experimental;

import "google/api/expr/v1/syntax.proto";
import "google/protobuf/descriptor.proto";


// A definition of a method overload.
// If a method is annotated with more than one overload with the same (or no)
// name, the first field of each overload must have a distinct type.
message Overload {
  // A designation of component fields of the target type.
  // This is a series of fields, specified as the struct paths of the
  // target message.
  message ComponentFields {
    // A single field within a method signature.
    // If a signature contains more than one field with a default, the same
    // type must not be used more than once.
    message Field {
      // Required. A dot-separated path for the field within the request
      // object. This should be specified using the identifiers in the proto,
      // and relative to the top level of the request type.
      //
      // Using a repeated field as a non-terminal field is erroneous.
      string path = 1;

      // Optional. The default value.
      // Fields are considered optional if they have a default, required
      // otherwise.
      google.api.expr.v1.Expr default_expr = 2;
    }

    // The fields which should compose the method signature, in order.
    // Required fields (those without defaults) must precede optional ones.
    repeated Field fields = 1;
  }

  // Optional. The name of the overload.
  // This controls the name of used for the function if a separate function
  // name is desirable across all clients.
  string name = 1;

  // The designation of component fields to define a method overload.
  ComponentFields component_fields = 10;
}


extend google.protobuf.MethodOptions {
  // The overloads defined for this method.
  repeated Overload overloads = 51500;
}
